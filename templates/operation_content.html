<div class="card">
  <div class="card-body">
    <h2 class="card-title">执行出入库操作</h2>
    <form id="operationForm" class="mt-3">
      <div class="mb-3">
        <label for="device_id" class="form-label">选择设备</label>
        <select class="form-control" id="device_id" name="device_id" required>
          {% for device in devices %}
          <option value="{{ device[0] }}">{{ device[1] }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="mb-3">
        <label for="operation" class="form-label">操作类型</label>
        <select class="form-control" id="operation" name="operation" required>
          <option value="in">入库</option>
          <option value="out">出库</option>
        </select>
      </div>
      <div class="mb-3">
        <label for="quantity" class="form-label">数量</label>
        <input
          type="number"
          class="form-control"
          id="quantity"
          name="quantity"
          required
          min="1"
        />
      </div>
      <div class="mb-3">
        <label for="operator" class="form-label">操作人</label>
        <select class="form-control" id="operator" name="operator" required>
          <option value="雒家俊" selected>雒家俊</option>
          <option value="杨昊罡">杨昊罡</option>
          <option value="刘九龙">刘九龙</option>
        </select>
      </div>
      <div class="mb-3">
        <label for="source_destination" class="form-label">来源或去处</label>
        <input
          type="text"
          class="form-control"
          id="source_destination"
          name="source_destination"
          required
        />
      </div>
      <button type="submit" class="btn btn-primary">提交</button>
    </form>
    <div id="message" class="mt-3"></div>
  </div>
</div>
<script>
  $("#operationForm").on("submit", function (e) {
    e.preventDefault();
    $.ajax({
      url: "/api/operation",
      type: "POST",
      data: $(this).serialize(),
      success: function (response) {
        $("#message")
          .text(response.message)
          .removeClass("text-danger")
          .addClass("text-success");
      },
      error: function (xhr) {
        $("#message")
          .text(xhr.responseJSON.message)
          .removeClass("text-success")
          .addClass("text-danger");
      },
    });
  });
</script>
